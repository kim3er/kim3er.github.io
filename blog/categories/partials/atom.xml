<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Partials | Adventures in brine]]></title>
  <link href="http://rich.k3r.me/blog/categories/partials/atom.xml" rel="self"/>
  <link href="http://rich.k3r.me/"/>
  <updated>2015-02-12T07:21:48+00:00</updated>
  <id>http://rich.k3r.me/</id>
  <author>
    <name><![CDATA[Richard Kimber]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Helpers as Partial Controllers]]></title>
    <link href="http://rich.k3r.me/blog/2015/01/31/helpers-as-partial-controllers/"/>
    <updated>2015-01-31T18:08:46+00:00</updated>
    <id>http://rich.k3r.me/blog/2015/01/31/helpers-as-partial-controllers</id>
    <content type="html"><![CDATA[<p>This is the first of what I expect will be a series of posts, about revelations that are entirely obvious in hindsight, but whose simplicity had eluded me for so long.</p>

<p>I came to Rails from ASP.NET MVC (have I told you about my <a href="http://www.amazon.co.uk/ASP-Net-MVC-Cookbook-Andrew-Siemer/dp/1849690308">book</a>), as part of a three pronged transition:</p>

<ol>
<li>Microsoft stack > Open source stack</li>
<li>IDE (VS2010) > Smart text editor (TextMate at the time, now Sublime Text 3)</li>
<li>Windows PC > Mac</li>
</ol>


<!--more-->


<p>The one thing I remember missing most when transitioning from ASP.NET MVC to Rails, was not being able to <a href="http://haacked.com/archive/2009/11/18/aspnetmvc2-render-action.aspx/">render actions</a> within a view. I&rsquo;m not going to regurgitate Phil Haack&rsquo;s example here (by the way, when did he start working at Github? He was part of my MS dream team). Basically, what we&rsquo;re talking about is rendering a partial that is attached to a controller. This way the logic is as portable as the partial itself, without putting logic into the actual partial; something I used a lot in ASP.NET MVC.</p>

<h2>Where there&rsquo;s a will there&rsquo;s a gem</h2>

<p>When I&rsquo;d convinced myself there wasn&rsquo;t a direct replacement for this functionality, I went about searching for a gem. What I found, was <a href="https://github.com/apotonick/cells">Cells</a>. This is about four years ago now, so I&rsquo;m happy to see the gem is still so active. It is pretty much a direct replacement for the functionality I was looking for and I did use it for a few projects. Thing is though, it wasn&rsquo;t really clicking with the other Rails devs I was working with.</p>

<p>I think maybe it was an &ldquo;against the grain&rdquo;, purest, &ldquo;this isn&rsquo;t the Rails way&rdquo; sort of reaction. But maybe they just saw what I couldn&rsquo;t; that there is a very easy way to accomplish my specific requirement. Either way, after the initial surge of wanting to use every gem under the sum, you gradually begin wanting to slim down your dependancies, and well, Cells didn&rsquo;t make the cut.</p>

<h2>So, to the point. Helpers</h2>

<p>Oh my god, it&rsquo;s so obvious now. For years I was ruefully sticking logic directly into my partial views, thinking &ldquo;Well, if I can&rsquo;t render actions, what else can I do?&rdquo;. What a doofus.</p>

<p>On a recent project, I was tired of the <code>locals</code> syntax of a partial I was using quite a lot.</p>

<pre><code class="ruby">render( partial: "path/to/partial", locals: { param_one: "something" } )
</code></pre>

<p>Really tiresome, I know. Anyway, as the partial was being used more, the logic being stuck into said partial was also increasing exponentially.</p>

<p>&#8220;` erb partial.html.erb
&lt;%
param_three = false unless defined?( param_three )</p>

<p>if param_two == &ldquo;Something&rdquo;
    param_one = &ldquo;Something incredibly hideous&rdquo;
end
%></p>

<p><p class="<%= "yuck" if param_three == true %>>
    &lt;%= &ldquo;#{param_two} - #{param_one}&rdquo; %>
</p>
&#8220;`</p>

<p>In spite of the disgrace my partial had become, what really irked me was having to type in <code>locals</code> every time I rendered the partial. &ldquo;I know, I&rsquo;ll put it into a helper method&rdquo;, I thought.</p>

<pre><code class="ruby something_helpers.rb">module SomethingHelpers

    def render_something(param_one, param_two, param_three = false)
        render( partial: "path/to/partial", locals: { param_one: param_one, param_two: param_two, param_three: param_three })
    end

end
</code></pre>

<p>And then the revelation, &ldquo;Hang on a minute, I can put my logic in here as well&rdquo;. Hello.</p>

<pre><code class="ruby something_helpers.rb">module SomethingHelpers

    def render_something(param_one, param_two, param_three = false)
        if param_two == "Something"
            param_one = "Something incredibly hideous"
        end

        text = "#{param_two} - #{param_one}"

        render( partial: "path/to/partial", locals: { text: text, param_three: param_three })
    end

end
</code></pre>

<pre><code class="erb partial.html.erb">&lt;p class="&lt;%= "yuck" if param_three == true %&gt;&gt;
    &lt;%= text %&gt;
&lt;/p&gt;
</code></pre>

<p>Seriously, sometimes I worry about me. I think I probably have this revelation every six months or so, then forget it. Hopefully after writing this, I won&rsquo;t forget again.</p>
]]></content>
  </entry>
  
</feed>
